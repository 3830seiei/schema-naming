#- metadata -----------------------------------------------
metadata:
  description: テーブル定義書
  author: H.Miyazawa
  history:
  - version: 1.0.0
    date: '2025-06-27'
    author: H.Miyazawa
    comment: OptiServe用のデータベース設計

#- tableinfo ----------------------------------------------
table_name: facility_upload_log
description: 医療機関のデータアップロード履歴テーブル
#- columns info -------------------------------------------
columns:
- name: uploadlog_id
  description: アップロードログID
  data_type: serial
  primary_key: true
  nullable: false
  comment: null
- name: medical_facility_id
  description: 医療機関ID
  data_type: integer
  primary_key: false
  nullable: false
  comment: null
  references:
    table: mst_medical_facility
    column: medical_facility_id
    enforced: false  # DB制約無し
    on_delete: restrict  # restrict, cascade, set null, no action
    on_update: restrict
    comment: 'mst_medical_facilityテーブルのmedical_facility_idを参照。医療機関ID。'
- name: file_type
  description: アップロードされたファイルの種類
  data_type: integer
  primary_key: false
  nullable: false
  comment: 'アップロードされたファイルの種類。1: 医療機器台帳, 2: 貸出履歴, 3: 故障履歴。'
- name: file_name
  description: アップロードされたファイル名
  data_type: text
  primary_key: false
  nullable: false
  comment: 'アップロードされたファイルの名前。'
- name: upload_at
  description: アップロード日時
  data_type: timestamp
  primary_key: false
  nullable: false
  comment: 'アップロードが行われた日時'
- name: upload_user_id
  description: アップロードを行ったユーザーID
  data_type: integer
  primary_key: false
  nullable: false
  comment: 'アップロードを行ったユーザーのID。ユーザーマスタのuser_idと紐づく。'
- name: download_at
  description: システム側でのダウンロード日時
  data_type: timestamp
  primary_key: false
  nullable: true
  comment: 'システム側でのダウンロードが行われた日時。ダウンロードが行われていない場合はNULL。'
- name: regdate
  description: データ作成日
  data_type: timestamp
  primary_key: false
  nullable: false
  comment: null
- name: lastupdate
  description: 最終更新日
  data_type: timestamp
  primary_key: false
  nullable: false
  comment: null

#- indexes info -------------------------------------------
indexes:
- name: idx_facility_upload_log_medical_facility_id_file_type
  columns: [medical_facility_id]
  unique: false
  comment: '医療機関IDに対するインデックス。医療機関ごとのアップロード履歴を効率的に検索するためのインデックス。'
